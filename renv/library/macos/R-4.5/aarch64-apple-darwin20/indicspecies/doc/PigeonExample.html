<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Miquel De Cáceres, CREAF" />
<meta name="author" content="Oriol Lapiedra, CREAF" />

<meta name="date" content="2025-02-20" />

<title>Usage of the niche metric functions (former ‘resniche’ package)</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Usage of the niche metric functions (former
‘resniche’ package)</h1>
<h4 class="author">Miquel De Cáceres, CREAF</h4>
<h4 class="author">Oriol Lapiedra, CREAF</h4>
<h4 class="date">2025-02-20</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#resemblance-between-diet-resources" id="toc-resemblance-between-diet-resources">Resemblance between diet
resources</a></li>
<li><a href="#resource-niche-analysis-at-the-population-level" id="toc-resource-niche-analysis-at-the-population-level">Resource niche
analysis at the population level</a>
<ul>
<li><a href="#resource-use-of-populations" id="toc-resource-use-of-populations">Resource use of
populations</a></li>
<li><a href="#niche-breadth-in-populations" id="toc-niche-breadth-in-populations">Niche breadth in
populations</a></li>
<li><a href="#overlap-between-populations" id="toc-overlap-between-populations">Overlap between
populations</a></li>
</ul></li>
<li><a href="#resource-niche-analysis-at-the-individual-level" id="toc-resource-niche-analysis-at-the-individual-level">Resource niche
analysis at the individual level</a>
<ul>
<li><a href="#resource-use-of-individuals" id="toc-resource-use-of-individuals">Resource use of
individuals</a></li>
<li><a href="#measuring-the-degree-of-individual-specialisation" id="toc-measuring-the-degree-of-individual-specialisation">Measuring the
degree of individual specialisation</a></li>
<li><a href="#measuring-the-degree-of-overlap-between-individuals" id="toc-measuring-the-degree-of-overlap-between-individuals">Measuring
the degree of overlap between individuals</a></li>
</ul></li>
<li><a href="#bibliography" id="toc-bibliography">Bibliography</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this document we show how to use the functions described in <span class="citation">De Cáceres et al. (2011)</span> by following an example
of dietary preferences in pigeons belonging to two populations (Moià and
Barcelona) in Catalonia (north east of Spain). We begin by loading the
library and the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(indicspecies)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(pigeons)</span></code></pre></div>
<p>The data consists of three items: the resource use matrix for each
pigeon population and the matrix of dissimilarities between pairs of
resources (seeds).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;dfood&quot;          &quot;diet.barcelona&quot; &quot;diet.moia&quot;      &quot;groups&quot;        </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;groupskm&quot;       &quot;indval&quot;         &quot;indvalori&quot;      &quot;indvalrest&quot;    </span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;indvalspcomb&quot;   &quot;p&quot;              &quot;pcv&quot;            &quot;phi&quot;           </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; [13] &quot;prefsign&quot;       &quot;prefstat&quot;       &quot;sc&quot;             &quot;sc2&quot;           </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; [17] &quot;wetcomb&quot;        &quot;wetkm&quot;          &quot;wetland&quot;        &quot;wetlandpa&quot;</span></span></code></pre></div>
</div>
<div id="resemblance-between-diet-resources" class="section level2">
<h2>Resemblance between diet resources</h2>
<p>Before starting any resource niche calculation, we can inspect the
matrix of dissimilarities between the <span class="math inline">\(r=6\)</span> resources, <span class="math inline">\(\mathbf{D}\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>dfood</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;                Oats      Peas   Popcorn       Soy Sunflower</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Peas      0.7029375                                        </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Popcorn   0.3706196 0.5070959                              </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Soy       0.7738801 0.6645980 0.8638219                    </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Sunflower 0.7656489 0.9773428 0.8784905 0.8669801          </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Wheat     0.3948828 0.5705974 0.2836482 0.7740283 1.0000000</span></span></code></pre></div>
<p>These can be summarized using a dendrogram. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(dfood, <span class="at">method=</span><span class="st">&quot;average&quot;</span>), <span class="at">h=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Distance&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Some seeds are quite similar (e.g. popcorn, wheat or oats), whereas
sunflower differs substantially from all other resources.</p>
</div>
<div id="resource-niche-analysis-at-the-population-level" class="section level2">
<h2>Resource niche analysis at the population level</h2>
<div id="resource-use-of-populations" class="section level3">
<h3>Resource use of populations</h3>
<p>We begin by showing the resource use data for pigeons of Barcelona
and Moia, expressed as proportions (i.e., the vector <span class="math inline">\(\mathbf{f}\)</span> for each population):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>diet.pop.barcelona <span class="ot">&lt;-</span> <span class="fu">colSums</span>(diet.barcelona)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">round</span>(diet.pop.barcelona<span class="sc">/</span><span class="fu">sum</span>(diet.pop.barcelona), <span class="at">dig=</span><span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;      Oats      Peas   Popcorn       Soy Sunflower     Wheat </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;     0.049     0.001     0.028     0.024     0.455     0.442</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>diet.pop.moia <span class="ot">&lt;-</span> <span class="fu">colSums</span>(diet.moia)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">round</span>(diet.pop.moia<span class="sc">/</span><span class="fu">sum</span>(diet.pop.moia), <span class="at">dig=</span><span class="dv">3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;      Oats      Peas   Popcorn       Soy Sunflower     Wheat </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;     0.002     0.018     0.091     0.045     0.054     0.791</span></span></code></pre></div>
<p>Whereas pigeons in Moià feed almost exclusively on wheat, those of
Barcelona combine wheat and sunflower seeds.</p>
</div>
<div id="niche-breadth-in-populations" class="section level3">
<h3>Niche breadth in populations</h3>
<p>We will determine the resource niche breadth of each of the two
populations as <span class="citation">De Cáceres et al.
(2011)</span>:</p>
<p><span class="math inline">\(B_{pop} =
(1/2)\sum_{j=1}^r\sum_{k=1}^r{f_jf_kd_{jk}}\)</span></p>
<p>We first conduct our calculations without taking into account the
resemblance between resources (which is equal to stating that <span class="math inline">\(d_{jk}=1\)</span> in all cases):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">nichevar</span>(<span class="at">P=</span>diet.barcelona, <span class="at">mode=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;               B        LC        UC</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; Niche 0.2966578 0.2715577 0.3394703</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">nichevar</span>(<span class="at">P=</span>diet.moia, <span class="at">mode=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;               B        LC        UC</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; Niche 0.1807663 0.1108429 0.2672015</span></span></code></pre></div>
<p>In general, we can say that the niche breadth of the population in
Moià is smaller than the niche breadth of the population in Barcelona.
If we repeat the same calculations with the matrix of resource
resemblance, we realize that the niche breadth of both populations
becomes smaller:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>popvar.barcelona <span class="ot">&lt;-</span> <span class="fu">nichevar</span>(<span class="at">P=</span>diet.barcelona, <span class="at">D=</span>dfood, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                            <span class="at">mode=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>popvar.barcelona</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;               B        LC        UC</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Niche 0.2453822 0.2328504 0.2562198</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>popvar.moia <span class="ot">&lt;-</span> <span class="fu">nichevar</span>(<span class="at">P=</span>diet.moia, <span class="at">D=</span>dfood, <span class="at">mode=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>popvar.moia</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;               B         LC        UC</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Niche 0.0853328 0.02684419 0.1738667</span></span></code></pre></div>
<p>The reason is that the first analysis was assuming that all resources
were equally (and maximally) distinct, while the second analysis
accounts for the similarity between some resources. Moreover, note that
the niche breadth of Moià has decreased more than the niche breadth of
Barcelona. This reflects that the resources being used by pigeons of
Moià are more similar than the resources used by pigeons of
Barcelona.</p>
</div>
<div id="overlap-between-populations" class="section level3">
<h3>Overlap between populations</h3>
<p>We can now calculate the niche overlap between the two pigeon
populations: <span class="math display">\[
O_{12} =
\frac{\sum_{j=1}^r\sum_{k=1}^r{f_{1j}f_{2k}(1-d_{jk}^2)}}{\sqrt{\sum_{j=1}^r\sum_{k=1}^r{f_{1j}f_{1k}(1-d_{jk}^2)}\sum_{j=1}^r\sum_{k=1}^r{f_{2j}f_{2k}(1-d_{jk}^2)}}}
\]</span> Using function <code>nicheoverlap()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">nicheoverlap</span>(<span class="at">P1=</span>diet.barcelona, <span class="at">P2=</span>diet.moia, <span class="at">mode=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;                 O        LC        UC</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; Overlap 0.7419319 0.4594609 0.9239177</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">nicheoverlap</span>(<span class="at">P1=</span>diet.barcelona, <span class="at">P2=</span>diet.moia, <span class="at">mode=</span><span class="st">&quot;single&quot;</span>, <span class="at">D =</span> dfood)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;                 O      LC        UC</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Overlap 0.7912472 0.55329 0.9434199</span></span></code></pre></div>
<p>If we include the resemblance between resources, the degree of
overlap increases, for the same reason that we obtained smaller niche
breadth statistics when resemblances were included.</p>
</div>
</div>
<div id="resource-niche-analysis-at-the-individual-level" class="section level2">
<h2>Resource niche analysis at the individual level</h2>
<p>In this section, we perform a resource niche analysis at individual
level. In particular, we are interested in assessing how much the
resource niche of individuals differs from that of their corresponding
population. For this, we need to calculate a measure of the degree of
individual specialization.</p>
<div id="resource-use-of-individuals" class="section level3">
<h3>Resource use of individuals</h3>
<p>We begin by showing the resource use data for all 23 pigeons in the
sample from the Barcelona population, expressed as proportions (i.e.,
matrix <span class="math inline">\(\mathbf{F}\)</span> for
Barcelona):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sweep</span>(diet.barcelona, <span class="dv">1</span>, <span class="at">FUN=</span><span class="st">&quot;/&quot;</span>, </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>            <span class="fu">rowSums</span>(diet.barcelona)), <span class="at">dig=</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;     Oats  Peas Popcorn   Soy Sunflower Wheat</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 1  0.000 0.000   0.000 0.000     0.020 0.980</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 2  0.000 0.000   0.000 0.000     1.000 0.000</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 3  0.000 0.000   0.000 0.000     1.000 0.000</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 4  0.025 0.000   0.153 0.000     0.000 0.822</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 5  0.000 0.000   0.000 0.000     0.965 0.035</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 6  0.000 0.023   0.136 0.000     0.648 0.193</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 7  0.000 0.000   0.000 0.000     0.795 0.205</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 8  0.042 0.000   0.000 0.000     0.000 0.958</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 9  1.000 0.000   0.000 0.000     0.000 0.000</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 10 0.014 0.000   0.000 0.000     0.014 0.973</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 11 0.000 0.000   0.000 0.000     0.350 0.650</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 12 0.000 0.000   0.000 0.000     0.047 0.953</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 13 0.000 0.000   0.000 0.000     0.437 0.562</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 14 0.000 0.000   0.000 0.000     0.389 0.611</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 15 0.000 0.000   0.000 0.549     0.451 0.000</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; 16 0.000 0.000   0.000 0.000     0.913 0.087</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; 17 0.000 0.000   0.113 0.075     0.755 0.057</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 18 0.000 0.000   0.043 0.000     0.743 0.214</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; 19 0.000 0.000   0.000 0.000     0.667 0.333</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; 20 0.000 0.000   0.000 0.000     0.367 0.633</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 21 0.000 0.000   0.000 0.000     0.910 0.090</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 22 0.000 0.000   0.019 0.019     0.786 0.175</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 23 0.442 0.000   0.000 0.000     0.000 0.558</span></span></code></pre></div>
<p>We see that most individuals in Barcelona feed on either sunflower or
wheat, but there are some individuals (like pigeon 9) which prefer oats.
Now we display the resource use data for the 19 pigeons representing the
population in Moià (i.e., matrix <span class="math inline">\(\mathbf{F}\)</span> for Moià):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sweep</span>(diet.moia, <span class="dv">1</span>, <span class="at">FUN=</span><span class="st">&quot;/&quot;</span>, </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>            <span class="fu">rowSums</span>(diet.moia)), <span class="at">dig=</span><span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;     Oats  Peas Popcorn   Soy Sunflower Wheat</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; 1  0.000 0.000   0.000 0.324     0.000 0.676</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; 2  0.000 0.000   0.000 0.012     0.000 0.988</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; 3  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; 4  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; 5  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 6  0.000 0.000   0.267 0.000     0.000 0.733</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; 7  0.000 0.000   0.319 0.000     0.000 0.681</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; 8  0.027 0.311   0.041 0.000     0.000 0.622</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; 9  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 10 0.000 0.000   0.148 0.000     0.000 0.852</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 11 0.000 0.000   0.200 0.000     0.000 0.800</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; 12 0.000 0.000   0.235 0.000     0.000 0.765</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; 13 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; 14 0.000 0.000   0.119 0.339     0.136 0.407</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 15 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; 16 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; 17 0.000 0.000   0.430 0.000     0.000 0.570</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; 18 0.000 0.000   0.000 0.000     0.583 0.417</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; 19 0.000 0.000   0.000 0.000     1.000 0.000</span></span></code></pre></div>
<p>Many pigeons from Moià feed on wheat seeds almost exclusively, but
some of them have broader preferences.</p>
</div>
<div id="measuring-the-degree-of-individual-specialisation" class="section level3">
<h3>Measuring the degree of individual specialisation</h3>
<p>We begin our resource niche analysis by calculating the niche breadth
of each individual in the population, <span class="math inline">\(B_i\)</span>: <span class="math display">\[
B_i = (1/2)\sum_{j=1}^r\sum_{k=1}^r{f_{ij}f_{ik}d_{jk}}
\]</span> We calculate the values for the individuals of both
populations:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>indvar.barcelona <span class="ot">&lt;-</span> <span class="fu">nichevar</span>(<span class="at">P=</span>diet.barcelona, <span class="at">D=</span>dfood)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">summary</span>(indvar.barcelona)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;        B          </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.00000  </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:0.01755  </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  Median :0.08153  </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;  Mean   :0.11168  </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:0.19890  </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;  Max.   :0.24609</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>indvar.moia <span class="ot">&lt;-</span> <span class="fu">nichevar</span>(<span class="at">P=</span>diet.moia, <span class="at">D=</span>dfood)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">summary</span>(indvar.moia)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;        B          </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.00000  </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:0.00000  </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;  Median :0.01015  </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;  Mean   :0.04031  </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:0.01861  </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;  Max.   :0.24306</span></span></code></pre></div>
<p>Most individuals have niche breadths that are smaller than the niche
breadth of their corresponding population, although a few individuals in
Moià have niche breadths larger than the population value. A niche
breadth equal to zero indicates that only one resource is exploited.</p>
<p>We can compare the niche breadth values of the two populations using
a non-parametric test.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(indvar.barcelona<span class="sc">$</span>B, indvar.moia<span class="sc">$</span>B)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; Warning in wilcox.test.default(indvar.barcelona$B, indvar.moia$B): no es pot</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; calcular un p-valor exacte amb empats</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; data:  indvar.barcelona$B and indvar.moia$B</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; W = 328, p-value = 0.005446</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>The Wilcoxon test confirms that the niche breadth of pigeons in
Barcelona is generally higher than that of pigeons in Moià, as we saw at
the population level.</p>
<p>In order to calculate the degree of individual specialization, <span class="citation">Bolnick et al. (2002)</span> defined WIC/TNW, i.e. the
ratio between the within individual component (i.e. average niche width)
and the total niche width of the population. Similarly we define the
following specialization measure, that takes into account the
resemblance between resources: <span class="math display">\[
S_{pop} = \frac{\sum_{i=n}^n{B_i}/n}{B_{pop}}
\]</span> where <span class="math inline">\(B_i\)</span> is the niche
breadth of each individual, and <span class="math inline">\(B_{pop}\)</span> is the niche breadth of the
population. Note that it is possible that <span class="math inline">\(B_i\)</span> values can be larger than <span class="math inline">\(B_{pop}\)</span>. However, we do not expect the
average of <span class="math inline">\(B_i\)</span> values to be larger
than <span class="math inline">\(B_{pop}\)</span>. If we calculate <span class="math inline">\(S_{pop}\)</span> for the two populations we
have:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>Spec.barcelona <span class="ot">&lt;-</span> <span class="fu">mean</span>(indvar.barcelona<span class="sc">$</span>B)<span class="sc">/</span>popvar.barcelona<span class="sc">$</span>B</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>Spec.barcelona</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.4551234</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>Spec.moia <span class="ot">&lt;-</span> <span class="fu">mean</span>(indvar.moia<span class="sc">$</span>B)<span class="sc">/</span>popvar.moia<span class="sc">$</span>B</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>Spec.moia</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.4723618</span></span></code></pre></div>
<p>Surprisingly, the degree of specialization in Moià seems slightly
higher than that in Barcelona. To see whether this holds statistically,
we can calculate the degree of specialization of each individual: <span class="math display">\[
S_i = \frac{B_i}{B_{pop}}
\]</span> which, in R, is:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>Spec.ind.barcelona <span class="ot">&lt;-</span> indvar.barcelona<span class="sc">$</span>B<span class="sc">/</span>popvar.barcelona<span class="sc">$</span>B</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>Spec.ind.moia <span class="ot">&lt;-</span> indvar.moia<span class="sc">$</span>B<span class="sc">/</span>popvar.moia<span class="sc">$</span>B</span></code></pre></div>
<p>Finally, we compare this two vectors in a Wilcoxon test:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(Spec.ind.barcelona, Spec.ind.moia)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; Warning in wilcox.test.default(Spec.ind.barcelona, Spec.ind.moia): no es pot</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; calcular un p-valor exacte amb empats</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; data:  Spec.ind.barcelona and Spec.ind.moia</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; W = 277, p-value = 0.1392</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>Which tells us that those differences in individual specialization
are not statistically significant.</p>
</div>
<div id="measuring-the-degree-of-overlap-between-individuals" class="section level3">
<h3>Measuring the degree of overlap between individuals</h3>
<p>The idea of this section is to determine how much the niche of each
individual overlaps with the niche of other individuals in the
population. This can be done by calling function
<code>nicheoverlap()</code> using <code>mode = &quot;pairwise&quot;</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>O.barcelona <span class="ot">&lt;-</span> <span class="fu">nicheoverlap</span>(diet.barcelona,<span class="at">D=</span>dfood, <span class="at">mode=</span><span class="st">&quot;pairwise&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>O.moia <span class="ot">&lt;-</span> <span class="fu">nicheoverlap</span>(diet.moia,<span class="at">D=</span>dfood, <span class="at">mode=</span><span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<p>These calls to <code>nicheoverlap()</code> return a symmetric square
matrix with as many rows and columns as individuals in the resource use
data frame. Each cell value in the symmetric matrix is the overlap
between two individuals of the population. Using these matrices we can
derive the average overlap in each population:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">mean</span>(O.barcelona[<span class="fu">lower.tri</span>(O.barcelona)])</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.6726374</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">mean</span>(O.moia[<span class="fu">lower.tri</span>(O.moia)])</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.8438816</span></span></code></pre></div>
<p>We can also calculate the average overlap between each individual and
the remaining individuals in its population:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>O.barcelona.ind <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(O.barcelona)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">nrow</span>(O.barcelona)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">summary</span>(O.barcelona.ind)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;  0.5400  0.6028  0.6558  0.6726  0.7595  0.8055</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>O.moia.ind <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(O.moia)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">nrow</span>(O.moia)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">summary</span>(O.moia.ind)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; 0.09157 0.89915 0.90649 0.84388 0.90965 0.91134</span></span></code></pre></div>
<p>We substracted one in the numerator and denominator in order to
exclude the target individual from the average (the overlap between a
resource niche and itself is always one). Apparently, the individuals in
Moià have a larger degree of overlap with individuals of their
population than individuals in Barcelona. A non-parametric test seems to
confirm this difference:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(O.barcelona.ind, O.moia.ind)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt; Warning in wilcox.test.default(O.barcelona.ind, O.moia.ind): no es pot calcular</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; un p-valor exacte amb empats</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; data:  O.barcelona.ind and O.moia.ind</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; W = 37, p-value = 4.549e-06</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
</div>
</div>
<div id="bibliography" class="section level2 unnumbered">
<h2 class="unnumbered">Bibliography</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bolnick2002" class="csl-entry">
Bolnick, Daniel I., Louie H. Yang, James a. Fordyce, Jeremy M. Davis,
and Richard Svanbäck. 2002. <span>“<span class="nocase">Measuring
individual-level resource specialization</span>.”</span>
<em>Ecology</em> 83 (10): 2936–41.
</div>
<div id="ref-DeCaceres2011" class="csl-entry">
De Cáceres, Miquel, Daniel Sol, Oriol Lapiedra, and Pierre Legendre.
2011. <span>“<span class="nocase">A framework for estimating niche
metrics using the resemblance between qualitative
resources</span>.”</span> <em>Oikos</em> 120 (February): 1341–50.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
